@model TSQ
    <style>
        .button {
            background-color: #4CAF50; /* Green */
            border: none;
            color: white;
            padding: 5px 5px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 12px;
            margin: 4px 2px;
            transition-duration: 0.4s;
            cursor: pointer;
        }

        .button1 {
            background-color: white;
            color: black;
            border: 2px solid #4CAF50;
        }

            .button1:hover {
                background-color: #4CAF50;
                color: white;
            }

        .button2 {
            background-color: white;
            color: black;
            border: 2px solid #008CBA;
        }

            .button2:hover {
                background-color: #008CBA;
                color: white;
            }

        .button3 {
            background-color: white;
            color: black;
            border: 2px solid #f44336;
        }

            .button3:hover {
                background-color: #f44336;
                color: white;
            }

        .button4 {
            background-color: white;
            color: black;
            border: 2px solid #e7e7e7;
        }

            .button4:hover {
                background-color: #e7e7e7;
            }

        .button5 {
            background-color: white;
            color: black;
            border: 2px solid #555555;
        }

            .button5:hover {
                background-color: #555555;
                color: white;
            }
    </style>

    <link href="~/css/DivMain.css" rel="stylesheet" />

<script src="~/js/excelFile.js"></script>

<div class="container fixed">
    <table class="container">
        <tr>
            <td>
                <form asp-action="TSQ" method="post">
                    <label asp-for="@Model.DateTime">Wybór daty:</label>
                    <input id="date" type="date" asp-for="@Model.DateTime">
                    <input type="submit" value="Submit" class="button button1">
                </form>
            </td>
            <td>
                <span class="align-middle">

                    <label>Export danych do pliku "Monitoring.xlsx":</label>

                    <br />

                    <button id="excelFile" class="button button5"> Export excel file</button>

                </span>
               
            </td>
            <td>
                <span class="align-middle">
                    <label>Export pliku csv z tabli:</label>

                    <br />

                    <button class="button button5" onclick="exportCSV('@Model.DateTime.ToShortDateString()' + '.csv')"> Export CSV </button>
                </span>
            </td>
        </tr>
    </table>


    <br />

    <h2>Data produkcji: @Model.DateTime.ToShortDateString()</h2>

    <br />

    <table id="tabela" class="table table-condensed " style="width:1300px">
        <thead class="thead-dark">
            <tr>
                <th>
                    <label style="font-size: 25px;"> Line </label>
                </th>
                <th>
                    <label style="font-size: 25px;"> Model </label>
                </th>
                <th>
                    <label style="font-size: 25px;"> I shift </label>
                </th>
                <th>
                    <label style="font-size: 25px;"> II shift </label>
                </th>
                <th>
                    <label style="font-size: 25px;"> III shift </label>
                </th>
                <th>
                    <label style="font-size: 25px;"> Total </label>
                </th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs1V50.Line </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs1V50.Model</label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs1V50.Shift1 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs1V50.Shift2 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs1V50.Shift3 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @(Model.LineWs1V50.ShiftsSum) </label>
                </td>
            </tr>

            <tr>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs1Cnh.Line </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs1Cnh.Model</label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs1Cnh.Shift1 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs1Cnh.Shift2 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs1Cnh.Shift3 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @(Model.LineWs1Cnh.ShiftsSum) </label>
                </td>
            </tr>

            <tr>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs2.Line </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs2.Model</label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs2.Shift1 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs2.Shift2 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs2.Shift3 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @(Model.LineWs2.ShiftsSum) </label>
                </td>
            </tr>

            <tr>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWS2HR18.Line </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWS2HR18.Model</label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWS2HR18.Shift1 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWS2HR18.Shift2 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWS2HR18.Shift3 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @(Model.LineWS2HR18.ShiftsSum) </label>
                </td>
            </tr>

            <tr>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3A_0LP1.Line </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3A_0LP1.Model</label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3A_0LP1.Shift1 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3A_0LP1.Shift2 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3A_0LP1.Shift3 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @(Model.LineWs3A_0LP1.ShiftsSum) </label>
                </td>
            </tr>

            <tr>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3A_1LP2_Rurki.Line </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3A_1LP2_Rurki.Model</label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3A_1LP2_Rurki.Shift1 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3A_1LP2_Rurki.Shift2 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3A_1LP2_Rurki.Shift3 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @(Model.LineWs3A_1LP2_Rurki.ShiftsSum) </label>
                </td>
            </tr>

            <tr>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3A_2LP1.Line </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3A_2LP1.Model</label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3A_2LP1.Shift1 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3A_2LP1.Shift2 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3A_2LP1.Shift3 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @(Model.LineWs3A_2LP1.ShiftsSum) </label>
                </td>
            </tr>

            <tr>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3A_2LP2.Line </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3A_2LP2.Model</label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3A_2LP2.Shift1 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3A_2LP2.Shift2 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3A_2LP2.Shift3 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @(Model.LineWs3A_2LP2.ShiftsSum) </label>
                </td>
            </tr>


            <tr>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3A_1LP1Gpf.Line </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3A_1LP1Gpf.Model</label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3A_1LP1Gpf.Shift1 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3A_1LP1Gpf.Shift2 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3A_1LP1Gpf.Shift3 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @(Model.LineWs3A_1LP1Gpf.ShiftsSum) </label>
                </td>
            </tr>

            <tr>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3A_2LP1Gpf.Line </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3A_2LP1Gpf.Model</label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3A_2LP1Gpf.Shift1 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3A_2LP1Gpf.Shift2 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3A_2LP1Gpf.Shift3 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @(Model.LineWs3A_2LP1Gpf.ShiftsSum) </label>
                </td>
            </tr>


            <tr>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3.Line </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3.Model</label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3.Shift1 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3.Shift2 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs3.Shift3 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @(Model.LineWs3.ShiftsSum) </label>
                </td>
            </tr>

            <tr>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs8_Bja.Line </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs8_Bja.Model</label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs8_Bja.Shift1 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs8_Bja.Shift2 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs8_Bja.Shift3 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @(Model.LineWs8_Bja.ShiftsSum) </label>
                </td>
            </tr>
            <tr>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs8_Gpf.Line </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs8_Gpf.Model</label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs8_Gpf.Shift1 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs8_Gpf.Shift2 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs8_Gpf.Shift3 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @(Model.LineWs8_Gpf.ShiftsSum) </label>
                </td>
            </tr>
            <tr>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs4M260A.Line </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs4M260A.Model</label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs4M260A.Shift1 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs4M260A.Shift2 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs4M260A.Shift3 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @(Model.LineWs4M260A.ShiftsSum) </label>
                </td>
            </tr>

            <tr>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs5.Line </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs5.Model</label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs5.Shift1 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs5.Shift2 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs5.Shift3 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @(Model.LineWs5.ShiftsSum) </label>
                </td>
            </tr>

            <tr>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs6.Line </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs6.Model</label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs6.Shift1 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs6.Shift2 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs6.Shift3 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @(Model.LineWs6.ShiftsSum) </label>
                </td>
            </tr>

            <tr>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf3.Line </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf3.Model</label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf3.Shift1 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf3.Shift2 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf3.Shift3 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @(Model.LineStf3.ShiftsSum) </label>
                </td>
            </tr>

            <tr>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf3M260.Line </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf3M260.Model</label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf3M260.Shift1 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf3M260.Shift2 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf3M260.Shift3 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @(Model.LineStf3M260.ShiftsSum) </label>
                </td>
            </tr>

            <tr>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf4.Line </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf4.Model</label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf4.Shift1 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf4.Shift2 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf4.Shift3 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @(Model.LineStf4.ShiftsSum) </label>
                </td>
            </tr>

            <tr>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf4Hr10.Line </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf4Hr10.Model</label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf4Hr10.Shift1 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf4Hr10.Shift2 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf4Hr10.Shift3 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @(Model.LineStf4Hr10.ShiftsSum) </label>
                </td>
            </tr>

            <tr>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf5.Line </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf5.Model</label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf5.Shift1 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf5.Shift2 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf5.Shift3 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @(Model.LineStf5.ShiftsSum) </label>
                </td>
            </tr>

            <tr>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf6.Line </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf6.Model</label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf6.Shift1 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf6.Shift2 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf6.Shift3 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @(Model.LineStf6.ShiftsSum) </label>
                </td>
            </tr>

            <tr>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf6Hr16.Line </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf6Hr16.Model</label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf6Hr16.Shift1 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf6Hr16.Shift2 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineStf6Hr16.Shift3 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @(Model.LineStf6Hr16.ShiftsSum) </label>
                </td>
            </tr>

            <tr>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWeil.Line </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWeil.Model</label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWeil.Shift1 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWeil.Shift2 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWeil.Shift3 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @(Model.LineWeil.ShiftsSum) </label>
                </td>
            </tr>

            <tr>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs7.Line </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs7.Model</label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs7.Shift1 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs7.Shift2 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @Model.LineWs7.Shift3 </label>
                </td>
                <td>
                    <label style="font-size: 18px;"> @(Model.LineWs7.ShiftsSum) </label>
                </td>
            </tr>
        </tbody>
    </table>

  

    @* <button onclick="exportFile()"> Export Excel </button>*@

</div>



<script>

    function exportCSV(fileName) {

        $('#tabela').table2csv({
            filename: fileName,
            separator: ';'
        });
    }

</script>

@*<script type="module">

        function exportFile() {
            //exportExcel(line, date, shift1, shift2, shift3)
            //line ws1 v50
            exportExcel('@Model.LineWs1V50.Line', '@Model.DateTime', '@Model.LineWs1V50.Shift1', '@Model.LineWs1V50.Shift2', '@Model.LineWs1V50.Shift3');
        }
    </script>*@
<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script>
    $(document).ready(function () {
        $('#excelFile').on('click', function () {
            var value = $('#date').val();

            // console.log(value);
            alert('Trwa generowanie danych...\n Proszę czekać na komunikat o statusie zakończonej pracy.');

            $.ajax(
                {
                    type: 'GET',
                    url: '@Url.Action("ExcelFile", "Raport")',
                    contentType: "application/json; charset=utf-8",
                    data: { dateTime: value },
                    success: function () { alert('Plik został zaktualizowany.'); },
                    error: function () { alert('Plik nie został zaktualizowany.\n' ); }
                });
        });
    });
</script>


